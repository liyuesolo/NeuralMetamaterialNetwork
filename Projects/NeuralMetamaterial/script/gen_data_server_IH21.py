import os
import sys
from joblib import Parallel, delayed, parallel_backend
def process(i, data):
    IH = 19
    params = data[i]
    exe_file = "../../../build/Projects/NeuralMetamaterial/NeuralMetamaterial"
    result_folder = "/" + str(i) + "/"
    if not os.path.isdir(result_folder):
        os.mkdir(result_folder)
    os.environ['OMP_THREAD_LIMIT'] = '1'
    # if os.path.exists(result_folder + "structure.vtk"):
    os.system(exe_file+" "+str(IH)+" " + result_folder + " 2 " + str(params[0]) + " " + str(params[1]) + " 0")
    


param_list = [ [0.0404772618089, 0.528948592268], 
[0.249782042201, 0.591076652655], 
[0.12210203285, 0.760006548772], 
[0.167183766038, 0.50115859611], 
[0.234060394375, 0.799823602289], 
[0.136581677728, 0.612717281195], 
[0.210427596914, 0.681748206812], 
[0.0440537266312, 0.621321015908], 
[0.0417994090923, 0.798812463972], 
[0.244907785782, 0.500953421789], 
[0.0921062353403, 0.69261775226], 
[0.110176915485, 0.551793439897], 
[0.249840648244, 0.726842866292], 
[0.206176602555, 0.622428033139], 
[0.180676454837, 0.799709874391], 
[0.171481176862, 0.7410303286], 
[0.108628925881, 0.500230308017], 
[0.0492353045238, 0.749260126776], 
[0.146043363486, 0.661526704469], 
[0.163272353016, 0.550651150081], 
[0.0928126501119, 0.799648886546], 
[0.248566381032, 0.64169949635], 
[0.0795320926558, 0.586156838567], 
[0.0655581729932, 0.660501894569], 
[0.221741035311, 0.53293330657], 
[0.15795948672, 0.698455429728], 
[0.0433021469942, 0.572076041844], 
[0.185433876047, 0.581639935999], 
[0.0724332455371, 0.500156732788], 
[0.123198135683, 0.712602777086], 
[0.0557161387921, 0.714091985074], 
[0.214698705075, 0.727980626527], 
[0.0890678041005, 0.748942489945], 
[0.203276048928, 0.502094034526], 
[0.186954590085, 0.651319775009], 
[0.199383414401, 0.772431177121], 
[0.24731030431, 0.674884256383], 
[0.118700382257, 0.638462979644], 
[0.0432968403833, 0.682753834865], 
[0.15333564677, 0.767743141375], 
[0.138181244213, 0.569174321401], 
[0.214677020099, 0.577759154643], 
[0.163775735895, 0.631681884887], 
[0.0732867759388, 0.620548858503], 
[0.235487686501, 0.752366056085], 
[0.120960464352, 0.799523496628], 
[0.0988088227896, 0.663832063397], 
[0.125068619291, 0.523381115228], 
[0.183963242035, 0.524492523039], 
[0.151765849661, 0.798058314807], 
[0.0402363507125, 0.501712742588], 
[0.181156097218, 0.684746635698], 
[0.0756174880991, 0.772041180158], 
[0.0690932476982, 0.526748288063], 
[0.124907403483, 0.676888676349], 
[0.189774042219, 0.555216643799], 
[0.0955449353976, 0.529954082859], 
[0.122440506337, 0.589155834769], 
[0.244803849512, 0.616910995597], 
[0.237886967923, 0.55119444409], 
[0.150841795784, 0.591749201618], 
[0.232082311912, 0.709019009168], 
[0.212947455045, 0.657254331353], 
[0.111311390671, 0.733367724034], 
[0.179401044375, 0.61393958843], 
[0.110813622242, 0.615807864915], 
[0.224804290158, 0.772891446563], 
[0.180673000641, 0.720362794455], 
[0.0525017741288, 0.774485676305], 
[0.0541976442673, 0.60114514716], 
[0.210533494242, 0.751343886066], 
[0.175960050778, 0.76702584213], 
[0.0993453431871, 0.76942556173], 
[0.131247792105, 0.500969437929], 
[0.197505678673, 0.700975489291], 
[0.160625598375, 0.528454341753], 
[0.0810504208417, 0.645070305255], 
[0.06660054094, 0.568265565237], 
[0.040839148397, 0.661314079194], 
[0.213752138439, 0.599443722656], 
[0.0912592831958, 0.561355654877], 
[0.223975716258, 0.638685113349], 
[0.201541865599, 0.799152419436], 
[0.149886968043, 0.746533619401], 
[0.0450611378928, 0.550183348102], 
[0.24133822505, 0.526558490902], 
[0.0626481392247, 0.694162214591], 
[0.101505967547, 0.712478735117], 
[0.24928515221, 0.568082174225], 
[0.144985380906, 0.714372265998], 
[0.14247491168, 0.63279945661], 
[0.0633948597328, 0.735075654292], 
[0.160594680175, 0.676520220598], 
[0.0763779011026, 0.546876998826], 
[0.132284357945, 0.73481620142], 
[0.166099839092, 0.654230983068], 
[0.0867731627341, 0.604185987638], 
[0.0799654944939, 0.674244570068], 
[0.233869060475, 0.660971733071], 
[0.194383596976, 0.734152772666], 
[0.200836300124, 0.539495996311], 
[0.138818484116, 0.550086382334], 
[0.11049957925, 0.570635947758], 
[0.0745694818416, 0.796264121493], 
[0.193710958773, 0.668859694744], 
[0.170378768798, 0.567818487793], 
[0.226767411999, 0.503889001628], 
[0.0571324076676, 0.634120654238], 
[0.110267223506, 0.690712484061], 
[0.195354981839, 0.60419594031], 
[0.116382771556, 0.777625856026], 
[0.203339285079, 0.640474536242], 
[0.0698467722581, 0.755770586224], 
[0.246143871232, 0.765834739881], 
[0.152312642193, 0.513406728401], 
[0.227823683567, 0.615652594071], 
[0.238747780467, 0.693494937985], 
[0.249926855001, 0.794911677248], 
[0.188339428053, 0.75586392137], 
[0.141330339597, 0.785268046328], 
[0.17734601322, 0.597194973425], 
[0.0613644153398, 0.677106117307], 
[0.18777100922, 0.784024474483], 
[0.0577219359892, 0.540064328043], 
[0.0940684690625, 0.733477199373], 
[0.116604739286, 0.654020273059], 
[0.111664946625, 0.534952389838], 
[0.204345464103, 0.517687301951], 
[0.108287190156, 0.600204732968], 
[0.227876724446, 0.736830970383], 
[0.0577390051343, 0.798751377221], 
[0.0563096776308, 0.585865651111], 
[0.15299162836, 0.574778610084], 
[0.146017517301, 0.535435258148], 
[0.08621179262, 0.712391536782], 
[0.146635102228, 0.68819023291], 
[0.0410660026367, 0.646176248903], 
[0.233525711723, 0.566517726503], 
[0.0402009096789, 0.766065699591], 
[0.208769066282, 0.564194459219], 
[0.16266771651, 0.779217023719], 
[0.0700066439575, 0.598792558582], 
[0.249922401891, 0.538587165549], 
[0.103514034228, 0.583688154064], 
[0.217783319847, 0.694270050849], 
[0.112139207782, 0.515139879945], 
[0.04780885436, 0.726065606263], 
[0.0524242961045, 0.509019535365], 
[0.236597842279, 0.586187472467], 
[0.0775798598992, 0.514647743765], 
[0.247158093684, 0.71237272849], 
[0.075181720357, 0.70170523706], 
[0.161076116395, 0.731904674429], 
[0.190209428584, 0.622945923136], 
[0.138510368889, 0.645925336492], 
[0.159531584605, 0.618827254986], 
[0.122808703535, 0.697649349085], 
[0.195845542543, 0.714647103015], 
[0.080197199355, 0.735863802832], 
[0.209995650076, 0.788887359942], 
[0.174544755292, 0.514394469473], 
[0.181660540617, 0.69814933408], 
[0.139481584383, 0.522050071937], 
[0.0570858702376, 0.615276809882], 
[0.127952563575, 0.559214508747], 
[0.173084101418, 0.542023978169], 
[0.223377802835, 0.51661596746], 
[0.22740838548, 0.597488310001], 
[0.0405912686701, 0.738299320144], 
[0.218469747551, 0.670018328712], 
[0.140877954788, 0.673871995171], 
[0.0889549661097, 0.777972738435], 
[0.137902549257, 0.590446176934], 
[0.1097582296, 0.788791074785], 
[0.246721080405, 0.65510770262], 
[0.0870683563347, 0.575243378233], 
[0.238092490695, 0.787037776218], 
[0.0452293747455, 0.695226987449], 
[0.0580708489279, 0.554265855883], 
[0.104546959095, 0.64944578039], 
[0.249007666707, 0.752170187073], 
[0.098663702248, 0.508438573921], 
[0.212805171163, 0.544470703343], 
[0.158448745561, 0.711956617149], 
[0.164073982953, 0.581341979458], 
[0.142658302971, 0.75694761861], 
[0.120432812232, 0.605884514798], 
[0.0851074515633, 0.500969314017], 
[0.249620018559, 0.60511374865], 
[0.189967682175, 0.567657133782], 
[0.069620756558, 0.636543352546], 
[0.0835952989401, 0.533564399897], 
[0.0519424965987, 0.522351631859], 
[0.0937924536196, 0.68038531201], 
[0.16855193159, 0.689604599164], 
[0.220003461642, 0.759777975529], 
[0.22176231104, 0.716301736802], 
[0.22100259576, 0.561064464907], 
[0.110002235323, 0.629326476357], 
[0.0987157976063, 0.609610307081], 
[0.184057136562, 0.742935588836], 
[0.148720091492, 0.562353077327], 
[0.176306518603, 0.645052876205], 
[0.12405009892, 0.747938021947], 
[0.100147374841, 0.754093041343], 
[0.223456862203, 0.681742702137], 
[0.225706739051, 0.790183078819], 
[0.142213944282, 0.726618333685], 
[0.18156704947, 0.671820495311], 
[0.132307583095, 0.777190936672], 
[0.168899520272, 0.797049364167], 
[0.111974326359, 0.703892898142], 
[0.245121897252, 0.629648043183], 
[0.0886758588761, 0.657280331737], 
[0.164055089557, 0.761682104627], 
[0.125656798811, 0.618183024003], 
[0.0968442793921, 0.59536922029], 
[0.12926503954, 0.665711922834], 
[0.192942091531, 0.513953800692], 
[0.0553794882844, 0.65431465416], 
[0.15402438102, 0.63887347036], 
[0.249770229109, 0.552345751716], 
[0.0421195525453, 0.633261942786], 
[0.237031963257, 0.606266156121], 
[0.211106839288, 0.768537370846], 
[0.125992799609, 0.571435342995], 
[0.0748480029287, 0.715679107381], 
[0.0644862955923, 0.777504798853], 
[0.0712293325277, 0.684019626297], 
[0.201670974191, 0.594165427002], 
[0.20161924867, 0.552158458369], 
[0.143704578268, 0.601721241652], 
[0.101063602968, 0.637613036641], 
[0.153639313971, 0.501752957563], 
[0.249508584817, 0.738539512241], 
[0.208006540452, 0.610108379326], 
[0.0454814929354, 0.590133749736], 
[0.132903234369, 0.706003539593], 
[0.046851253522, 0.7884786969], 
[0.110336799114, 0.765329817946], 
[0.216618389588, 0.798686147015], 
[0.214357796742, 0.631260315809], 
[0.159263391099, 0.66475182039], 
[0.178710406077, 0.501773098159], 
[0.238040767618, 0.774881873641], 
[0.140245898771, 0.798549454379], 
[0.0967437912555, 0.788702498464], 
[0.174513762088, 0.624340072518], 
[0.198748554582, 0.679911963586], 
[0.204450836989, 0.739532010043], 
[0.148652053223, 0.613639748056], 
[0.172462361344, 0.529417234952], 
[0.0845764194683, 0.615584481748], 
[0.150673637456, 0.650443928992], 
[0.167977984263, 0.60341970497], 
[0.112438020549, 0.67954438989], 
[0.215422599314, 0.501481381106], 
[0.076997655964, 0.78521405793], 
[0.0881066738666, 0.518602917585], 
[0.238166994861, 0.731793127084], 
[0.150091183377, 0.546576044218], 
[0.0436658866814, 0.715279024753], 
[0.0604788835302, 0.500633914396], 
[0.168783362349, 0.716712987058], 
[0.0970884684693, 0.551790625114], 
[0.207420394159, 0.719297193885], 
[0.24856062557, 0.686220212554], 
[0.0532188344902, 0.564510028094], 
[0.196813369164, 0.583164094427], 
[0.173291773686, 0.663530692907], 
[0.129739769595, 0.636321941221], 
[0.23819598975, 0.647077103586], 
[0.115136728755, 0.722939982695], 
[0.169205307439, 0.701540667751], 
[0.0795222188158, 0.630949099097], 
[0.136588234569, 0.69269681079], 
[0.0413493766921, 0.513167384832], 
[0.216485988836, 0.74079890607], 
[0.185336052852, 0.632768070573], 
[0.0704756412378, 0.649932014174], 
[0.142954152638, 0.506283630899], 
[0.174423640745, 0.778311732774], 
[0.132322170652, 0.765667718028], 
[0.0774235770513, 0.56658966265], 
[0.0457295907315, 0.610154031501], 
[0.234017873916, 0.625025121553], 
[0.14514837608, 0.703296472367], 
[0.191046400983, 0.533984166446], 
[0.126697479313, 0.64935297945], 
[0.0931235001018, 0.721446691324], 
[0.118835042519, 0.545062474229], 
[0.208677603765, 0.701768049505], 
[0.0977282730805, 0.57179623338], 
[0.248720202436, 0.510972816782], 
[0.119949516752, 0.502086254303], 
[0.21070935227, 0.53206751674], 
[0.0614084517217, 0.766843633804], 
[0.0805868811582, 0.757608238728], 
[0.233909959595, 0.513018413686], 
[0.235879563077, 0.68301297607], 
[0.111755694305, 0.753833907961], 
[0.201744503012, 0.761580992472], 
[0.104842920729, 0.798567041428], 
[0.0520480504921, 0.664767051984], 
[0.069925980363, 0.72556351769], 
[0.19619542457, 0.658025356363], 
[0.142657158939, 0.771782321144], 
[0.0550443318929, 0.702475836269], 
[0.130438992875, 0.601880660701], 
[0.0600215720199, 0.745698905478], 
[0.0650209004036, 0.789920508158], 
[0.154745920112, 0.78719548033], 
[0.0995306090915, 0.626146269974], 
[0.0408739378633, 0.7769207382], 
[0.230004116725, 0.577275609354], 
[0.195825680842, 0.748034189478], 
[0.21590273279, 0.645961530807], 
[0.15302298309, 0.722948879387], 
[0.135184313592, 0.532283951869], 
[0.163714907306, 0.517415684842], 
[0.141903878069, 0.580064035244], 
[0.159895507353, 0.563960675227], 
[0.0689972144314, 0.585609416191], 
[0.203225845785, 0.691201879918], 
[0.06679418207, 0.610489367559], 
[0.0782228387372, 0.659267731551], 
[0.22888056925, 0.724291327793], 
[0.180275804447, 0.56206646639], 
[0.0452885045462, 0.538667624834], 
[0.159616072625, 0.540053461604], 
[0.0406143893817, 0.561953844345], 
[0.216439420602, 0.618314878046], 
[0.222168504494, 0.54982821804], 
[0.229492840231, 0.671865581009], 
[0.220198912746, 0.589670834406], 
[0.223555328652, 0.655651756588], 
[0.106898408754, 0.524520355428], 
[0.13321216535, 0.717288832607], 
[0.0900681464002, 0.764440481534], 
[0.160481448192, 0.743884103998], 
[0.185187157758, 0.77313754874], 
[0.179349838895, 0.708469100021], 
[0.0547338770678, 0.686943345883], 
[0.0912712086464, 0.54085115294], 
[0.231025021091, 0.762193690456], 
[0.083617942442, 0.68545693815], 
[0.0998947630124, 0.74213421547], 
[0.182755556918, 0.546586694683], 
[0.11874465832, 0.667459273603], 
[0.121391256401, 0.786816577095], 
[0.0916590918189, 0.585740048432], 
[0.123169454012, 0.534279567764], 
[0.181723243134, 0.732895948474], 
[0.190347188167, 0.794868378991], 
[0.223386981982, 0.749311262252], 
[0.0508924646447, 0.763129673136], 
[0.190030647647, 0.69056117618], 
[0.238794503402, 0.536697744176], 
[0.190990770655, 0.592931333833], 
[0.0521012857752, 0.736178909725], 
[0.0942339429884, 0.646534991845], 
[0.0817758277765, 0.724147065461], 
[0.136542367775, 0.624205300037], 
[0.0404972243311, 0.704487542764], 
[0.217939695301, 0.781132146661], 
[0.103032461984, 0.560998437023], 
[0.241184684886, 0.575982812548], 
[0.142708636761, 0.737991605251], 
[0.172810133967, 0.587130949407], 
[0.150525154053, 0.624711977981], 
[0.063090538519, 0.624667332892], 
[0.0616770545727, 0.51862194688], 
[0.176892181526, 0.789057980426], 
[0.123324637517, 0.512966737017], 
[0.16832961006, 0.751960324474], 
[0.246797849656, 0.780501195966], 
[0.102500608853, 0.697733503952], 
[0.204608630969, 0.574087988899], 
[0.117428069747, 0.578496659444], 
[0.165910262752, 0.64240614527], 
[0.188772742859, 0.503744064133], 
[0.192083048281, 0.64054319758], 
[0.172056311836, 0.675569142949], 
[0.230830159556, 0.524458329205], 
[0.104476820125, 0.725388514309], 
[0.0654400639867, 0.705735737507], 
[0.234844503382, 0.635355121379], 
[0.207699073957, 0.67178286769], 
[0.131434000498, 0.542300626376], 
[0.0593183932776, 0.575781651901], 
[0.122037604946, 0.687143392436], 
[0.0858002020027, 0.552214893444], 
[0.157289978544, 0.687110401824], 
[0.200712681106, 0.528059223587], 
[0.0588243021019, 0.725231565687], 
[0.228487655916, 0.540822383594], 
[0.24081973956, 0.721071115984], 
[0.150459023547, 0.525816754357], 
[0.122276222306, 0.628399849557], 
[0.0942034512452, 0.70507219923], 
]

Parallel(n_jobs=8)(delayed(process)(i, param_list) for i in range(len(param_list)))
# for i in range(int(sys.argv[1]), int(sys.argv[2])):
#     process(i, param_list)
# Parallel(n_jobs=8)(delayed(process)(i, param_list) for i in range(8))
# process(0, param_list)


